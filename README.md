# Итоговый отчет по проекту: Анализ временного ряда NYC Taxi Demand

## Введение

В рамках итогового проекта была выбрана задача анализа временного ряда количества поездок такси в Нью-Йорке с шагом в 30 минут. Данные взяты из открытого источника и включают временные метки и значения количества поездок.

Цель проекта — провести полный анализ временного ряда, включая:

- Предварительный анализ данных
- Прогнозирование значений с помощью различных методов
- Настройку и использование модели SARIMA
- Классификацию сегментов временного ряда по времени суток
- Классификацию с помощью глубокой нейронной сети
- Выявление аномалий в данных

---

## 1. Предварительный анализ

- Дата начала: 2014-07-01 00:00:00
- Дата конца: 2015-01-31 23:30:00
- Количество наблюдений: 10320
- Частота: 30 минут (проверено по интервалу между метками)
- Данные не содержат пропусков

### График временного ряда

Наблюдается чёткая суточная и недельная сезонность, а также выраженные пики и провалы. Есть аномально высокие значения, подлежащие дальнейшему анализу.

---

## 2. Базовые методы прогнозирования

Были реализованы следующие подходы:

- **Наивный прогноз**: последнее значение train
- **Скользящее среднее**: по последним 48 точкам
- **Экспоненциальное сглаживание**

Оценка по метрикам:

| Метод                  | MAE     | RMSE    | MAPE    |
|------------------------|---------|---------|---------|
| Наивный прогноз        | 13156   | 15292   | 5142%   |
| Скользящее среднее     | 7175    | 8810    | 3278%   |
| Экспоненциальное сглаж.| 13155   | 15291   | 5142%   |

**Вывод**: Скользящее среднее показало наилучший результат из трёх базовых методов.

---

## 3. SARIMA

Для построения модели использована SARIMA(p,d,q)(P,D,Q,s) с параметрами (2,0,2)(1,1,1,48), где 48 — сезонность (сутки).

Метрики на тестовой выборке:

- **MAE**: 14073
- **RMSE**: 15450
- **MAPE**: 3713%

**Вывод**: SARIMA учитывает сезонность, но в данном случае переобучилась на пиковые значения. По качеству проигрывает скользящему среднему.

---

## 4. Классификация по времени суток

Цель: классификация 48-точечных сегментов по 4 классам: ночь, утро, день, вечер.

Применены методы:

- **kNN + DTW**
- **Time Series Forest (sktime)**
- **ROCKET**

### Результаты:

| Метод                 | Accuracy |
|-----------------------|----------|
| kNN + DTW             | 0.97     |
| Time Series Forest    | 0.97     |
| ROCKET                | 0.98     |

**Вывод**: Все три метода показали высокое качество, ROCKET — наилучшее.

---

## 5. Классификация с помощью нейросети (tsai)

Модель: InceptionTime, обучалась на тех же сегментах.

- **Accuracy**: 1.00 на валидации
- Обучение на GPU через CUDA

**Вывод**: Модель переобучилась на задаче с простыми и сбалансированными метками, но качество при этом отличное.

---

## 6. Обнаружение аномалий

Анализ проведен на полном ряду. Методы:

- **Z-score**
- **Isolation Forest**
- **AutoEncoder**

### Выводы:

- **Z-score**: Выявляет единичные экстремумы
- **Isolation Forest**: Детектирует выбросы по контексту, включая низкие значения
- **AutoEncoder**: Улавливает отклонения формы сигнала

**Рекомендации**: AutoEncoder и Isolation Forest показали наибольшую чувствительность к контексту, рекомендованы к применению в реальной задаче.

---

## Общие выводы

- Базовые методы прогнозирования в простых случаях дают хорошие результаты
- SARIMA уступает по качеству, но может быть полезна в задачах интерпретации
- Современные классификаторы и нейросети справляются отлично с задачей сегментной классификации
- Методы обнаружения аномалий дают разный спектр чувствительности — целесообразно использовать ансамбль

**Рекомендованный пайплайн**:
- Прогноз: MA + нейросеть
- Классификация: ROCKET или InceptionTime
- Аномалии: AutoEncoder + IsolationForest